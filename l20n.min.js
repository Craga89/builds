(function(e,t){function n(e,t,r){n.modules[e]=r}function r(e){var t=e.split("/"),n=[];for(var r=0;r<t.length;r++)t[r]!="."&&(t[r]==".."?n.pop():n.push(t[r]));return n.join("/")}function i(e,t){return e?e.trim().replace(/\/*$/,"/")+t.trim():t.trim()}function s(e){return e?e.split("/").slice(0,-1).join("/"):null}function o(e,u){u=r(i(s(e),u));if(u in n.exports)return n.exports[u];if(u in n.modules){var a=n.modules[u];if(typeof a=="function"){var f={},l=a(o.bind(null,u),f,{id:u,uri:""});a=l!==t?l:f}return n.exports[u]=a}throw new Error("Module not defined: "+u)}n.modules={},n.exports={};var u=o.bind(null,null);n("l20n/html",["require","exports","module","l20n","l20n/promise","l20n/platform/io","l20n/platform/intl"],function(e,t,n){"use strict";function l(){var e=document.head,t=e.querySelector('script[type="application/l10n-data+json"]');t&&(a.data=JSON.parse(t.textContent));var n=e.querySelectorAll('script[type="application/l20n"]');if(n.length){for(var r=0;r<n.length;r++)n[r].hasAttribute("src")?a.linkResource(n[r].getAttribute("src")):a.addResource(n[r].textContent);p()}else{var i=e.querySelector('link[rel="localization"]');i?v(i.getAttribute("href")).then(p):console.warn("L20n: No resources found. (Put them above l20n.js.)")}document.addEventListener("readystatechange",h)}function c(e){o=a.localize(e.ids,function(t){e||(e=g(document.body));for(var n=0;n<e.nodes.length;n++)y(e.nodes[n],e.ids[n],t.entities[e.ids[n]]);e=null,f||(m(),f=!0)}),a.removeEventListener("ready",u)}function h(){var e=g(document.body);a.isReady?c(e):(u=c.bind(this,e),a.addEventListener("ready",u)),document.removeEventListener("readystatechange",h)}function p(){a.freeze(),a.addEventListener("error",console.warn),document.l10n=a,document.l10n.localizeNode=function(t){var n=g(t),r=o.extend(n.ids);for(var i=0;i<n.nodes.length;i++)y(n.nodes[i],n.ids[i],r.entities[n.ids[i]])}}function d(t){var n=/{{\s*lang\s*}}/,r=e("./platform/intl").Intl,i=r.prioritizeLocales(t.languages,[navigator.language]);a.registerLocales.apply(a,i),t.resources.forEach(function(e){n.test(e)?a.linkResource(e.replace.bind(e,n)):a.linkResource(e)})}function v(e){var t=new i;return s.loadAsync(e).then(function(e){var n=JSON.parse(e);d(n),t.fulfill()}),t}function m(){var e=document.createEvent("Event");e.initEvent("DocumentLocalized",!1,!1),document.dispatchEvent(e)}function g(e){var t=e.querySelectorAll("[data-l10n-id]"),n=[];e.hasAttribute("data-l10n-id")&&(t=Array.prototype.slice.call(t),t.push(e));for(var r=0;r<t.length;r++)n.push(t[r].getAttribute("data-l10n-id"));return{ids:n,nodes:t}}function y(e,t,n){if(!n)return;n.value&&(e.textContent=n.value);for(key in n.attributes)e.setAttribute(key,n.attributes[key])}var r=e("../l20n"),i=e("./promise").Promise,s=e("./platform/io"),o,u,a=r.getContext(document.location.host),f=!1;return l(),r}),n("l20n",["require","exports","module","l20n/context","l20n/parser","l20n/compiler"],function(e,t,n){"use strict";var r=e("./l20n/context").Context,i=e("./l20n/parser").Parser,s=e("./l20n/compiler").Compiler;t.Context=r,t.Parser=i,t.Compiler=s,t.getContext=function(t){return new r(t)}}),n("l20n/context",["require","exports","module","l20n/events","l20n/parser","l20n/compiler","l20n/promise","l20n/retranslation","l20n/platform/globals","l20n/platform/io"],function(e,n,r){"use strict";function l(e,t){function i(e,t){if(e>=7)throw new p("Too many nested imports.");if(!t){s(t),o(),a(e+1,t),c();return}return s(t).then(o).then(a.bind(this,e+1,t)).then(c)}function s(e){if(!e){if(n.source)return n.source;try{return n.source=f.loadSync(n.id)}catch(t){if(t instanceof f.Error)return n.source="";throw t}}if(n.source){var r=new u;return r.fulfill(),r}return f.loadAsync(n.id).then(function(t){n.source=t})}function o(){n.ast=t.parse(n.source)}function a(e,i){var s=n.ast.body.filter(function(e,t){return e.type=="ImportStatement"?(r.push(t),!0):!1});s.forEach(function(e){var r=h(e.uri.content),i=new l(r,t);n.resources.push(i)});var o=[];n.resources.forEach(function(t){o.push(t.build(e,i))});if(i)return u.all(o)}function c(){for(var e=n.resources.length-1;e>=0;e--){var t=r[e]||0;Array.prototype.splice.apply(n.ast.body,[t,1].concat(n.resources[e].ast.body))}n.isReady=!0}function h(e){if(n.id===null||e[0]=="/")return e;var t=n.id.split("/").slice(0,-1).join("/");return t?(t[t.length-1]=="/"&&(t=t.slice(0,t.length-1)),t+"/"+e):"./"+e}var n=this;this.id=e,this.resources=[],this.source=null,this.isReady=!1,this.ast={type:"LOL",body:[]},this.build=i;var r=[]}function c(e,n,r){function s(e){return e?o(e).then(a).then(f):(o(e),a(),f(),this)}function o(e){var t=[];i.resources.forEach(function(n){t.push(n.build(0,e))});if(e)return u.all(t)}function a(){i.ast.body=i.resources.reduce(function(e,t){return e.concat(t.ast.body)},i.ast.body)}function f(){i.entries=r.compile(i.ast),i.isReady=!0}function l(e){return this.entries.hasOwnProperty(e)?this.entries[e]:t}function c(e){return this.resources.some(function(t){return t.id===e})}this.id=e,this.resources=[],this.entries=null,this.ast={type:"LOL",body:[]},this.isReady=!1,this.build=s,this.getEntry=l,this.hasResource=c;var i=this}function h(e){function E(e,t){if(!this.isReady)throw new p("Context not ready");return k.call(this,0,e,t).value}function S(e,t){if(!this.isReady)throw new p("Context not ready");return k.call(this,0,e,t)}function x(e,t){if(!t)throw new p("No callback passed");return T.call(this,e,t)}function T(e,t,n){var r={extend:function(r){for(var i=0;i<r.length;i++)e.indexOf(r[i])===-1&&e.push(r[i]);if(!this.isReady)return;var s=N.call(this,r);return b.bindGet({id:t,callback:T.bind(this,e,t),globals:Object.keys(s.globalsUsed)},!0),s}.bind(this)};if(!this.isReady)return b.bindGet({id:t,callback:T.bind(this,e,t),globals:[]}),r;var i=N.call(this,e),s={entities:i.entities,reason:n};return b.bindGet({id:t,callback:T.bind(this,e,t),globals:Object.keys(i.globalsUsed)}),t(s),r}function N(e){var t={entities:{},globalsUsed:{}};for(var n=0,r;r=e[n];n++){t.entities[r]=S.call(this,r);for(var i in t.entities[r].globals)t.globalsUsed[i]=!0}return t}function C(e){return n.length-e==0?u:r[n[e]]}function k(e,r,i,s){var u=C(e);if(!u){var a=new v("Entity couldn't be retrieved",r,n);return m.emit("error",a),{value:s?s:r,attributes:{},globals:{}}}u.isReady||u.build(!1);var f=u.getEntry(r);if(f===t)return m.emit("error",new d("Not found",r,u.id)),k.call(this,e+1,r,i,s);try{return f.get(L.call(this,i))}catch(l){if(l instanceof o.RuntimeError)return m.emit("error",new d(l.message,r,u.id)),k.call(this,e+1,r,i,s||l.source);throw l}}function L(e){if(!e)return this.data;var t={};for(var n in this.data)t[n]=this.data[n];if(e)for(n in e)t[n]=e[n];return t}function A(e){u===t&&(u=new c(null,g,y));var n=new l(null,g);n.source=e,u.resources.push(n)}function O(e){f.push(e)}function M(e){return typeof e=="function"?_(e):D(e)}function _(e){for(var t in r){var n=e(t);r[t].hasResource(n)||r[t].resources.push(new l(n,g))}return!0}function D(e){var i=new l(e,g);if(n.length!==0)for(var s in r)r[s].hasResource(e)||r[s].resources.push(i);return u===t&&(u=new c(null,g,y)),u.hasResource(e)||u.resources.push(i),!0}function P(){if(h&&!this.isReady)throw new p("Context not ready");n=[];for(var e in arguments){var t=arguments[e];n.push(t),t in r||(r[t]=new c(t,g,y))}h&&H.call(this)}function H(){h=!0;for(var e=0;e<f.length;e++)M(f[e]);var t=n.length>0?r[n[0]]:u;return t.isReady?B.call(this):t.build(!0).then(B.bind(this))}function B(){this.isReady=!0,b.all(n),m.emit("ready")}function j(e,t){m.addEventListener(e,t)}function F(e,t){m.removeEventListener(e,t)}function I(e){m.emit("error",e)}this.id=e,this.data={},this.isReady=!1,this.addResource=A,this.linkResource=O,this.registerLocales=P,this.freeze=H,this.get=E,this.getEntity=S,this.localize=x,this.addEventListener=j,this.removeEventListener=F;var n=[],r={},u,f=[],h=!1,m=new i,g=new s,y=new o,b=new a,w=[];g.addEventListener("error",I),y.addEventListener("error",I),y.setGlobals(b.globals)}function p(e){this.name="ContextError",this.message=e}function d(e,t,n){p.call(this,e),this.name="EntityError",this.id=t,this.lang=n,this.message="["+n+"] "+t+": "+e}function v(e,t,n){p.call(this,e),this.name="GetError",this.id=t,this.tried=n,n.length?this.message=t+": "+e+"; tried "+n.join(", "):this.message=t+": "+e}var i=e("./events").EventEmitter,s=e("./parser").Parser,o=e("./compiler").Compiler,u=e("./promise").Promise,a=e("./retranslation").RetranslationManager;e("./platform/globals");var f=e("./platform/io");h.Error=p,h.EntityError=d,p.prototype=Object.create(Error.prototype),p.prototype.constructor=p,d.prototype=Object.create(p.prototype),d.prototype.constructor=d,v.prototype=Object.create(p.prototype),v.prototype.constructor=v,n.Context=h}),n("l20n/events",["require","exports","module"],function(e,t,n){"use strict";function r(){this._listeners={}}r.prototype.emit=function(){var t=Array.prototype.slice.call(arguments),n=t.shift(),r=this._listeners[n];return!r||!r.length?!1:(r.forEach(function(e){e.apply(this,t)},this),!0)},r.prototype.addEventListener=function(t,n){return this._listeners[t]||(this._listeners[t]=[]),this._listeners[t].push(n),this},r.prototype.removeEventListener=function(t,n){var r=this._listeners[t],i=r.indexOf(n);return i===-1?this:(r.splice(i,1),this)},t.EventEmitter=r}),n("l20n/parser",["require","exports","module","l20n/events"],function(e,n,r){"use strict";function s(e){function f(){r+=2;var e=r,t=n.indexOf("*/",e);if(t===-1)throw G("Comment without closing tag");return r=t+2,{type:"Comment",content:n.slice(e,t)}}function l(){var e=[],t,i,s;for(;;){t=h(),t.local=t.key.name.charAt(0)==="_",e.push(t),i=m(),s=n.charAt(r);if(s===">")break;if(!i)throw G('Expected ">"')}return e}function c(e){var t=b();g();if(n.charAt(r)!==":")throw G('Expected ":"');return++r,g(),{type:e,key:t,value:v()}}function h(e){var t=b(),i=[];n.charAt(r)==="["&&(++r,g(),i=Q(M,"]")),g();if(n.charAt(r)!==":")throw G('Expected ":"');return++r,g(),{type:e,key:t,value:v(),index:i}}function p(){++r,g();if(n.charAt(r)==="}")return++r,{type:"Hash",content:[]};var e,t,i,s=[];for(;;){e=!1;if(n.charAt(r)==="*"){++r;if(e)throw G("Default item redefinition forbidden");e=!0}t=c("HashItem"),t["default"]=e,s.push(t),g(),i=n.charAt(r)===",",i&&(++r,g());if(n.charAt(r)==="}"){++r;break}if(!i)throw G('Expected "}"')}return{type:"Hash",content:s}}function d(e){var t=e.length,i=r+t,s=n.indexOf(e,i);while(s!==-1&&n.charCodeAt(s-1)===92&&n.charCodeAt(s-2)!==92)s=n.indexOf(e,s+t);if(s===-1)throw G("Unclosed string literal");var o=n.slice(i,s);return r=s+t,{type:"String",content:o}}function v(e,i){i===t&&(i=n.charAt(r));if(i==="'"||i==='"')return i===n.charAt(r+1)&&i===n.charAt(r+2)?d(i+i+i):d(i);if(i==="{")return p();if(!e)throw G("Unknown value type");return null}function m(){var e=r,t=n.charCodeAt(e);while(t===32||t===10||t===9||t===13)t=n.charCodeAt(++r);return r!==e}function g(){var e=n.charCodeAt(r);while(e===32||e===10||e===9||e===13)e=n.charCodeAt(++r)}function y(){return++r,{type:"VariableExpression",id:b()}}function b(){var e=r,t=e,i=n,s=i.charCodeAt(t);if((s<97||s>122)&&(s<65||s>90)&&s!==95)throw G("Identifier has to start with [a-zA-Z]");s=i.charCodeAt(++e);while(s>=95&&s<=122||s>=65&&s<=90||s>=48&&s<=57||s===95)s=i.charCodeAt(++e);return r+=e-t,{type:"Identifier",name:i.slice(t,e)}}function w(){r+=6;if(n.charAt(r)!=="(")throw G('Expected "("');++r,g();var e=d(n.charAt(r));g();if(n.charAt(r)!==")")throw G('Expected ")"');return++r,{type:"ImportStatement",uri:e}}function E(e){if(e.name.charAt(0)==="_")throw G('Macro ID cannot start with "_"');++r;var t=Q(y,")");m();if(n.charAt(r)!=="{")throw G('Expected "{"');++r,g();var i=M();g();if(n.charAt(r)!=="}")throw G('Expected "}"');++r,g();if(n.charCodeAt(r)!==62)throw G('Expected ">"');return++r,{type:"Macro",id:e,args:t,expression:i}}function S(e,t){if(!m())throw G("Expected white space");var i=n.charAt(r),s=v(!0,i),o=[];if(s===null){if(i===">")throw G('Expected ">"');o=l()}else{var u=m();if(n.charAt(r)!==">"){if(!u)throw G('Expected ">"');o=l()}}return g(),++r,{type:"Entity",id:e,value:s,index:t,attrs:o,local:e.name.charCodeAt(0)===95}}function x(){var e=n.charCodeAt(r);if(e===60){++r;var t=b();return e=n.charCodeAt(r),e===40?E(t):e===91?(++r,S(t,Q(M,"]"))):S(t,[])}if(n.charCodeAt(r)===47&&n.charCodeAt(r+1)===42)return f();if(n.slice(r,r+6)==="import")return w();throw G("Invalid entry")}function T(){var e,t,i=r,o=!1,u=n.indexOf("\\");while(u!==-1){e=n.charAt(u+1);if(e=='"'||e=="'"||e=="\\")n=n.substr(0,u)+n.substr(u+1);u=n.indexOf("\\",u+1)}u=n.indexOf("{{");while(u!==-1){if(n.charCodeAt(u-1)===92){n=n.substr(0,u-1)+n.substr(u),u=n.indexOf("{{",u+2);continue}o||(t=[],o=!0),i<u&&t.push({type:"String",content:n.slice(i,u)}),r=u+2,g(),t.push(M()),g();if(n.charCodeAt(r)!==125||n.charCodeAt(r+1)!==125)throw G('Expected "}}"');u=r+2,i=u,u=n.indexOf("{{",u)}return o?(i<s&&t.push({type:"String",content:n.slice(i)}),{type:"ComplexString",content:t}):{type:"String",content:n}}function N(){var e=[];g();while(r<s){try{e.push(x())}catch(t){if(!(t instanceof o))throw t;u.emit("error",t),e.push(Y())}r<s&&g()}return{type:"LOL",body:e}}function C(){var e=[];g();while(r<s)e.push(x()),r<s&&g();return{type:"LOL",body:e}}function k(e){n=e,r=0,s=n.length;try{return T()}catch(t){throw u&&t instanceof o&&u.emit("error",t),t}}function L(e){return n=e,r=0,s=n.length,a()}function A(e,t){if(!u)throw Error("Emitter not available");return u.addEventListener(e,t)}function O(e,t){if(!u)throw Error("Emitter not available");return u.removeEventListener(e,t)}function M(){return P()}function _(e,t,i,s){var o=s(),u,a;for(;;){u="",g(),a=n.charAt(r);if(e[0].indexOf(a)===-1)break;u+=a,++r;if(e.length>1){a=n.charAt(r);if(e[1]==a)++r,u+=a;else if(e[2])return--r,o}g(),o={type:t,operator:{type:i,token:u},left:o,right:s()}}return o}function D(e,t,i,s){var o=n.charCodeAt(r);return e.indexOf(o)===-1?s():(++r,g(),{type:t,operator:{type:i,token:String.fromCharCode(o)},argument:D(e,t,i,s)})}function P(){var e=H();g();if(n.charCodeAt(r)!==63)return e;++r,g();var t=M();g();if(n.charCodeAt(r)!==58)throw G('Expected ":"');return++r,g(),{type:"ConditionalExpression",test:e,consequent:t,alternate:M()}}function H(){return _([["|"],"|",!0],"LogicalExpression","LogicalOperator",B)}function B(){return _([["&"],"&",!0],"LogicalExpression","Logicalperator",j)}function j(){return _([["="],"=",!0],"BinaryExpression","BinaryOperator",F)}function F(){return _([["<",">"],"=",!1],"BinaryExpression","BinaryOperator",I)}function I(){return _([["+","-"]],"BinaryExpression","BinaryOperator",q)}function q(){return _([["%"]],"BinaryExpression","BinaryOperator",R)}function R(){return _([["*"]],"BinaryExpression","BinaryOperator",U)}function U(){return _([["/"]],"BinaryExpression","BinaryOperator",z)}function z(){return D([43,45,33],"UnaryExpression","UnaryOperator",$)}function W(e){return g(),{type:"CallExpression",callee:e,arguments:Q(M,")")}}function X(e,t){if(e.type!=="ParenthesisExpression"&&e.type!=="CallExpression"&&e.type!=="Identifier"&&e.type!=="ThisExpression")throw G("AttributeExpression must have Identifier, This, Call or Parenthesis as left node");var i;if(t){g(),i=M(),g();if(n.charAt(r)!=="]")throw G('Expected "]"');return++r,{type:"AttributeExpression",expression:e,attribute:i,computed:!0}}return i=b(),{type:"AttributeExpression",expression:e,attribute:i,computed:!1}}function V(e,t){var i;if(t){g(),i=M(),g();if(n.charAt(r)!=="]")throw G('Expected "]"');return++r,{type:"PropertyExpression",expression:e,property:i,computed:!0}}return i=b(),{type:"PropertyExpression",expression:e,property:i,computed:!1}}function $(){var e=J(),t;for(;;){t=n.charCodeAt(r);if(t===46||t===91)++r,e=V(e,t===91);else if(t===58&&n.charCodeAt(r+1)===58)r+=2,n.charCodeAt(r)===91?(++r,e=X(e,!0)):e=X(e,!1);else{if(t!==40)break;++r,e=W(e)}}return e}function J(){if(n.charCodeAt(r)===40){++r,g();var e={type:"ParenthesisExpression",expression:M()};g();if(n.charCodeAt(r)!==41)throw G('Expected ")"');return++r,e}return K()}function K(){var e=r,t=n.charCodeAt(e);while(t>47&&t<58)t=n.charCodeAt(++e);if(e>r){var i=r;return r=e,{type:"Number",value:parseInt(n.slice(i,e),10)}}switch(t){case 39:case 34:case 123:case 91:return v();case 36:return y();case 64:return++r,{type:"GlobalsExpression",id:b()};case 126:return++r,{type:"ThisExpression"};default:return b()}}function Q(e,t){var i;g();if(n.charAt(r)===t)return++r,[];var s=[];for(;;){s.push(e()),g(),i=n.charAt(r);if(i!==","){if(i===t){++r;break}throw G('Expected "," or "'+t+'"')}++r,g()}return s}function G(e,i){i===t&&(i=r);var s=n.lastIndexOf("<",i-1),u=n.lastIndexOf(">",i-1);s=u>s?u+1:s;var a=n.slice(s,i+10),f=e+" at pos "+i+': "'+a+'"';return new o(f,i,a)}function Y(){var e=n.indexOf("<",r),t;return e===-1?(t={type:"JunkEntry",content:n.slice(r)},r=s,t):(t={type:"JunkEntry",content:n.slice(r,e)},r=e,t)}this.parse=L,this.parseString=k,this.addEventListener=A,this.removeEventListener=O;var n,r,s,u,a;e?a=C:(u=new i,a=N)}function o(e,t,n){this.name="ParserError",this.message=e,this.pos=t,this.context=n}var i=e("./events").EventEmitter;s.Error=o,o.prototype=Object.create(Error.prototype),o.prototype.constructor=o,n.Parser=s}),n("l20n/compiler",["require","exports","module","l20n/events","l20n/parser"],function(e,n,r){"use strict";function o(){function p(e){r={};var t={Entity:b,Macro:E};for(var n=0,i;i=e.body[n];n++){var s=t[i.type];if(s)try{r[i.id.name]=new s(i)}catch(o){h(o)}}return r}function d(e){return o=e,!0}function v(t,n){return e.addEventListener(t,n)}function m(t,n){return e.removeEventListener(t,n)}function g(){return r={},o={},u.globals={},this}function y(t,n,r,i){var s=new t(n,r,i);return e.emit("error",s),s}function b(e){this.id=e.id.name,this.local=e.local||!1,this.index=[],this.attributes={},this.publicAttributes=[];var t;for(t=0;t<e.index.length;t++)this.index.push(x(e.index[t],this));for(t=0;t<e.attrs.length;t++){var n=e.attrs[t];this.attributes[n.key.name]=new w(n,this),n.local||this.publicAttributes.push(n.key.name)}this.value=x(e.value,this,this.index)}function w(e,t){this.key=e.key.name,this.local=e.local||!1,this.index=[];for(var n=0;n<e.index.length;n++)this.index.push(x(e.index[n],this));this.value=x(e.value,t,this.index),this.entity=t}function E(e){this.id=e.id.name,this.local=e.local||!1,this.expression=x(e.expression,this),this.args=e.args}function x(e,t,n){if(!e)return null;if(!S[e.type])throw y("CompilationError","Unknown expression type"+e.type);return n&&(n=n.slice()),S[e.type](e,t,n)}function T(e,t,n,r){if(!e||typeof e=="string"||typeof e=="boolean"||typeof e=="number")return e;if(e._resolve)return e._resolve(n);var i=e(t,n);return t=i[0],i=i[1],T(i,t,n)}function N(e,t){var n=e.name;return function(i,s){if(!r.hasOwnProperty(n))throw new f("Reference to an unknown entry: "+n,t);return i.__this__=r[n],[i,r[n]]}}function C(e,t){return function(t,n){return[t,t.__this__]}}function k(e,t){var n=e.id.name;return function(r,i){if(r.hasOwnProperty(n))return r[n];if(!i||!i.hasOwnProperty(n))throw new f("Reference to an unknown variable: "+n,t);return[r,i[n]]}}function L(e,t){var n=e.id.name;return function(r,i){if(!o)throw new f("Globals missing (tried @"+n+").",t);if(!o.hasOwnProperty(n))throw new f("Reference to an unknown global: "+n,t);try{var s=o[n].get()}catch(a){throw new f("Cannot evaluate global "+n,t)}return u.globals[n]=!0,[r,s]}}function A(e,t){return function(n,r){return[n,e.value]}}function O(e,t){var r,i;return function(o,u){if(!i){try{r=n.parseString(e.content)}catch(a){throw new l("Malformed string. "+a.message,t,e.content)}if(r.type=="String")return[o,r.content];i=x(r,t)}try{return[o,T(i,o,u)]}catch(a){throw h(a),new l(a.message,t,e.content)}}}function M(e,n,r){var i=[],s,o=r.length?r.shift():t;for(var u=0;u<e.content.length;u++){var a=e.content[u];i[a.key.name]=x(a.value,n,r),a.default&&(s=a.key.name)}return function(r,u,a){var f=[a,o,s],l=[];for(var p=0;p<f.length;p++){try{var d=f[p]=T(f[p],r,u)}catch(v){throw h(v),y(c,v.message,n)}if(d===t)continue;if(typeof d!="string")throw y(c,"Index must be a string",n);l.push(d);if(i.hasOwnProperty(d))return[r,i[d]]}throw y(c,l.length?'Hash key lookup failed (tried "'+l.join('", "')+'").':"Hash key lookup failed.",n)}}function _(e,t){var n=[];for(var r=0;r<e.content.length;r++)n.push(x(e.content[r],t));return function(){var e=!1;return function(i,s){if(e)throw new f("Cyclic reference detected",t);e=!0;var o=[];try{for(var u=0;u<n.length;u++){var a=T(n[u],i,s);if(typeof a!="string"&&typeof a!="number")throw new f("Placeables must be strings or numbers",t);o.push(a)}}finally{e=!1}return[i,o.join("")]}}()}function D(e,t){if(e=="-")return function(n){if(typeof n!="number")throw new f("The unary - operator takes a number",t);return-n};if(e=="+")return function(n){if(typeof n!="number")throw new f("The unary + operator takes a number",t);return+n};if(e=="!")return function(n){if(typeof n!="boolean")throw new f("The ! operator takes a boolean",t);return!n};throw y(a,"Unknown token: "+e,t)}function P(e,t){if(e=="==")return function(n,r){if(typeof n=="number"&&typeof r=="number"||typeof n=="string"&&typeof r=="string")return n==r;throw new f("The == operator takes two numbers or two strings",t)};if(e=="!=")return function(n,r){if(typeof n=="number"&&typeof r=="number"||typeof n=="string"&&typeof r=="string")return n!=r;throw new f("The != operator takes two numbers or two strings",t)};if(e=="<")return function(n,r){if(typeof n!="number"||typeof r!="number")throw new f("The < operator takes two numbers",t);return n<r};if(e=="<=")return function(n,r){if(typeof n!="number"||typeof r!="number")throw new f("The <= operator takes two numbers",t);return n<=r};if(e==">")return function(n,r){if(typeof n!="number"||typeof r!="number")throw new f("The > operator takes two numbers",t);return n>r};if(e==">=")return function(n,r){if(typeof n!="number"||typeof r!="number")throw new f("The >= operator takes two numbers",t);return n>=r};if(e=="+")return function(n,r){if(typeof n=="number"&&typeof r=="number"||typeof n=="string"&&typeof r=="string")return n+r;throw new f("The + operator takes two numbers or two strings",t)};if(e=="-")return function(n,r){if(typeof n!="number"||typeof r!="number")throw new f("The - operator takes numbers",t);return n-r};if(e=="*")return function(n,r){if(typeof n!="number"||typeof r!="number")throw new f("The * operator takes numbers",t);return n*r};if(e=="/")return function(n,r){if(typeof n!="number"||typeof r!="number")throw new f("The / operator takes two numbers",t);if(r==0)throw new f("Division by zero not allowed.",t);return n/r};if(e=="%")return function(n,r){if(typeof n!="number"||typeof r!="number")throw new f("The % operator takes two numbers",t);return n%r};throw y(a,"Unknown token: "+e,t)}function H(e,t){if(e=="&&")return function(n,r){if(typeof n!="boolean"||typeof r!="boolean")throw new f("The && operator takes two booleans",t);return n&&r};if(e=="||")return function(n,r){if(typeof n!="boolean"||typeof r!="boolean")throw new f("The || operator takes two booleans",t);return n||r};throw y(a,"Unknown token: "+e,t)}function B(e,t){var n=D(e.operator.token,t),r=x(e.argument,t);return function(t,i){return[t,n(T(r,t,i))]}}function j(e,t){var n=x(e.left,t),r=P(e.operator.token,t),i=x(e.right,t);return function(t,s){return[t,r(T(n,t,s),T(i,t,s))]}}function F(e,t){var n=x(e.left,t),r=H(e.operator.token,t),i=x(e.right,t);return function(t,s){return[t,r(T(n,t,s),T(i,t,s))]}}function I(e,t){var n=x(e.test,t),r=x(e.consequent,t),i=x(e.alternate,t);return function(s,o){var u=T(n,s,o);if(typeof u!="boolean")throw new f("Conditional expressions must test a boolean",t);return u===!0?r(s,o):i(s,o)}}function q(e,t){var n=x(e.callee,t),r=[];for(var i=0;i<e.arguments.length;i++)r.push(x(e.arguments[i],t));return function(i,s){var o=[];for(var u=0;u<r.length;u++)o.push(r[u](i,s));var a=n(i,s);i=a[0],a=a[1];if(!a._call)throw new f("Expected a macro, got a non-callable.",t);return a._call(s,o)}}function R(e,t){var n=x(e.expression,t),r=e.computed?x(e.property,t):e.property.name;return function(i,s){var o=T(r,i,s),u=n(i,s);i=u[0],u=u[1];if(u._yield)return u._yield(s,o);if(typeof u!="function"){if(!u.hasOwnProperty(o))throw new f(o+" is not defined in the context data",t);return[null,u[o]]}return u(i,s,o)}}function U(e,t){var n=x(e.expression,t),r=e.computed?x(e.attribute,t):e.attribute.name;return function(t,i){var s=T(r,t,i),o=n(t,i);return t=o[0],o=o[1],[t,o.attributes[s]]}}function z(e,t){return x(e.expression,t)}this.compile=p,this.setGlobals=d,this.addEventListener=v,this.removeEventListener=m,this.reset=g;var e=new i,n=new s(!0),r={},o={},u={globals:{}};b.prototype._yield=function(t,n){var r={__this__:this};return this.value(r,t,n)},b.prototype._resolve=function(t){var n={__this__:this};return T(this.value,n,t)},b.prototype.getString=function(n){try{return this._resolve(n)}catch(r){throw h(r),r instanceof l&&e.emit("error",r),r}},b.prototype.get=function(t){u.globals={};var n={value:this.getString(t),attributes:{}};for(var r=0,i;i=this.publicAttributes[r];r++)n.attributes[i]=this.attributes[i].getString(t);return n.globals=u.globals,n},w.prototype._yield=function(t,n){var r={__this__:this.entity};return this.value(r,t,n)},w.prototype._resolve=function(t){var n={__this__:this.entity};return T(this.value,n,t)},w.prototype.getString=function(n){try{return this._resolve(n)}catch(r){throw h(r),r instanceof l&&e.emit("error",r),r}},E.prototype._call=function(t,n){var r={__this__:this};for(var i=0;i<this.args.length;i++)r[this.args[i].id.name]=n[i];return this.expression(r,t)};var S={Identifier:N,ThisExpression:C,VariableExpression:k,GlobalsExpression:L,Number:A,String:O,Hash:M,HashItem:x,ComplexString:_,UnaryExpression:B,BinaryExpression:j,LogicalExpression:F,ConditionalExpression:I,CallExpression:q,PropertyExpression:R,AttributeExpression:U,ParenthesisExpression:z}}function u(e,t){this.name="CompilerError",this.message=e,this.entry=t.id}function a(e,t){u.call(this,e,t),this.name="CompilationError"}function f(e,t){u.call(this,e,t),this.name="RuntimeError"}function l(e,t,n){f.call(this,e,t),this.name="ValueError",this.source=n}function c(e,t){f.call(this,e,t),this.name="IndexError"}function h(e){if(!(e instanceof u))throw e}var i=e("./events").EventEmitter,s=e("./parser").Parser;o.Error=u,o.CompilationError=a,o.RuntimeError=f,o.ValueError=l,o.IndexError=c,u.prototype=Object.create(Error.prototype),u.prototype.constructor=u,a.prototype=Object.create(u.prototype),a.prototype.constructor=a,f.prototype=Object.create(u.prototype),f.prototype.constructor=f,l.prototype=Object.create(f.prototype),l.prototype.constructor=l,c.prototype=Object.create(f.prototype),c.prototype.constructor=c,n.Compiler=o}),n("l20n/promise",["require","exports","module"],function(e,t,n){"use strict";var r=function(){this._state=0,this._value=null,this._cb={fulfilled:[],rejected:[]},this._thenPromises=[]};r.all=function(e){function i(){n--,n==0&&t.fulfill()}var t=new r,n=e.length;if(n==0)return t.fulfill(),t;for(var s in e)e[s].then(i,i);return t},r.prototype.then=function(e,t){this._cb.fulfilled.push(e),this._cb.rejected.push(t);var n=new r;return this._thenPromises.push(n),this._state>0&&setTimeout(this._processQueue.bind(this),0),n},r.prototype.fulfill=function(e){return this._state!=0?this:(this._state=1,this._value=e,this._processQueue(),this)},r.prototype.reject=function(e){return this._state!=0?this:(this._state=2,this._value=e,this._processQueue(),this)},r.prototype._processQueue=function(){while(this._thenPromises.length){var e=this._cb.fulfilled.shift(),t=this._cb.rejected.shift();this._executeCallback(this._state==1?e:t)}},r.prototype._executeCallback=function(e){var t=this._thenPromises.shift();if(typeof e!="function"){this._state==1?t.fulfill(this._value):t.reject(this._value);return}try{var n=e(this._value);if(n&&typeof n.then=="function"){var r=function(e){t.fulfill(e)},i=function(e){t.reject(e)};n.then(r,i)}else t.fulfill(n)}catch(s){t.reject(s)}},t.Promise=r}),n("l20n/retranslation",["require","exports","module","l20n/events"],function(e,t,n){"use strict";function i(){function s(n){var r=new n;this.globals[r.id]=r,t[r.id]=0,r.addEventListener("change",function(t){for(var n=0;n<e.length;n++)e[n]&&e[n].globals.indexOf(t)!==-1&&e[n].callback({global:r.id})})}function o(r,i){var s,o;for(s=0;s<n.length;s++)if(n[s].id===r.id){o=!0;break}o?i&&(n[s]=r):n.push(r);var u;for(s=0;s<e.length;s++)if(e[s]&&e[s].id===r.id){u=e[s];break}if(!u)r.globals.length!=0&&(e.push(r),r.globals.forEach(function(e){t[e]++,this.globals[e].activate()},this));else if(i){u.callback=r.callback;var a=r.globals.filter(function(e){return u.globals.indexOf(e)===-1});a.forEach(function(e){t[e]++,this.globals[e].activate()},this),u.globals=u.globals.concat(a)}else if(r.globals.length==0)delete e[s];else{var a=r.globals.filter(function(e){return u.globals.indexOf(e)===-1});a.forEach(function(e){t[e]++,this.globals[e].activate()},this);var f=u.globals.filter(function(e){return r.globals.indexOf(e)===-1});f.forEach(function(e){t[e]--,t[e]==0&&this.globals[e].deactivate()},this),u.globals=r.globals}}function u(e){for(var t=0;t<n.length;t++)n[t].callback({locales:e})}var e=[],t={},n=[];this.bindGet=o,this.all=u,this.globals={};for(var r in i._constructors)s.call(this,i._constructors[r])}var r=e("./events").EventEmitter;i._constructors=[],i.registerGlobal=function(e){i._constructors.push(e)},t.RetranslationManager=i}),n("l20n/platform/globals",["require","exports","module","l20n/events","l20n/retranslation"],function(t,n,r){"use strict";function o(){this.id=null,this._emitter=new i,this.value=null,this.isActive=!1}function u(){function n(){return{width:document.body.clientWidth}}function r(){this.isActive||(e.addEventListener("resize",s),this.isActive=!0)}function i(){e.removeEventListener("resize",s),this.value=null,this.isActive=!1}function s(){t.value={width:document.body.clientWidth},t._emitter.emit("change",t.id)}o.call(this),this.id="screen",this._get=n,this.activate=r,this.deactivate=i;var t=this}function a(){function e(){return/^MacIntel/.test(navigator.platform)?"mac":/^Linux/.test(navigator.platform)?"linux":/^Win/.test(navigatgor.platform)?"win":"unknown"}o.call(this),this.id="os",this.get=e}function f(){function r(){var e=new Date;return e.getHours()}function i(){var t=new Date;t.getHours()!==e.value&&(e.value=t.getHours(),e._emitter.emit("change",e.id))}function s(){if(!this.isActive){var e=new Date;n=setTimeout(function(){i(),n=setInterval(i,t)},t-e.getTime()%t),this.isActive=!0}}function u(){clearInterval(n),this.value=null,this.isActive=!1}o.call(this),this.id="hour",this._get=r,this.activate=s,this.deactivate=u;var e=this,t=36e5,n=null}var i=t("../events").EventEmitter,s=t("../retranslation").RetranslationManager;o.prototype._get=function(){throw new Error("Not implemented")},o.prototype.get=function(){if(!this.value||!this.isActive)this.value=this._get();return this.value},o.prototype.addEventListener=function(e,t){if(e!=="change")throw"Unknown event type";this._emitter.addEventListener(e,t)},u.prototype=Object.create(o.prototype),u.prototype.constructor=u,a.prototype=Object.create(o.prototype),a.prototype.constructor=a,f.prototype=Object.create(o.prototype),f.prototype.constructor=f,s.registerGlobal(u),s.registerGlobal(a),s.registerGlobal(f),n.Global=o}),n("l20n/platform/io",["require","exports","module","l20n/promise"],function(e,t,n){"use strict";function i(e){this.name="IOError",this.message=e}var r=e("../promise").Promise;t.loadAsync=function(t){var n=new r,s=new XMLHttpRequest;return s.overrideMimeType("text/plain"),s.addEventListener("load",function(){if(s.status==200)n.fulfill(s.responseText);else{var e=new i("Not found: "+t);n.reject(e)}}),s.addEventListener("abort",function(e){return n.reject(e)}),s.open("GET",t,!0),s.send(""),n},t.loadSync=function(t){var n=new XMLHttpRequest;n.overrideMimeType("text/plain"),n.open("GET",t,!1),n.send("");if(n.status==200)return n.responseText;throw new i("Not found: "+t)},i.prototype=Object.create(Error.prototype),i.prototype.constructor=i,t.Error=i}),n("l20n/platform/intl",["require","exports","module"],function(e,n,r){"use strict";function s(e){return!0}function o(e){return e}function u(){return i.defaultLocale}function a(e){if(e===t)return[];var n=[];typeof e=="string"&&(e=new Array(e));var r=e.length,i=0;while(i<r){var u=i.toString(),a=e.hasOwnProperty(u);if(a){var f=e[u];if(typeof f!="string"&&typeof f!="object")throw new TypeError;var l=f.toString();if(!s(l))throw new RangeError;var l=o(l);n.indexOf(l)===-1&&n.push(l)}i+=1}return n}function f(e,n){var r=n;for(;;){if(e.indexOf(r)!==-1)return r;var i=r.lastIndexOf("-");if(i===-1)return t;i>=2&&r[i-2]=="-"&&(i-=2),r=r.substr(0,i)}}function l(e,n){var r=0,i=n.length,s=t;while(r<i&&s===t){var o=n[r],a=o,s=f(e,a);r+=1}var l={};if(s!==t){l.locale=s;if(o!==a)throw"NotImplemented"}else l.locale=u();return l}function h(e,n,r,i,s){var o=r.localeMatcher;if(o=="lookup")var u=l(e,n);else var u=c(e,n);var a=u.locale;if(u.hasOwnProperty("extension"))throw"NotImplemented";var f={};f.dataLocale=a;var h="-u",p=0,d=0;i!==t&&(d=i.length);while(p<d){var v=i[p.toString()],m=s(a),g=m[a],y=g[0],b="";if(extensionSubtags!==t)throw"NotImplemented";if(r.hasOwnProperty("key")){var w=r.key;g.indexOf(w)!==-1&&w!==y&&(y=w,b=""),f.key=y,h+=b,p+=1}}if(h.length>2)var E=a.substr(0,extensionIndex),S=a.substr(extensionIndex+1),a=E+h+S;return f.locale=a,f}function p(e,t){var n={localeMatcher:"lookup"},r=h(e,t,n),i=e.indexOf(r.locale);return i===-1?e:(e.splice(i,1),e.unshift(r.locale),e)}var i={defaultLocale:"en-US",systemLocales:["en-US"]},c=l;n.Intl={prioritizeLocales:p}}),e.L20n=u("l20n"),u("l20n/html")})(window)